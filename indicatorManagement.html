<!-- public/pages/indicatorManagement.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Indicator Management</title>
    <style>
        #indicator-management-panel {
            padding: 20px;
            background-color: #f5f5f5;
            border-radius: 5px;
            width: 300px;
        }

        #indicator-list {
            list-style-type: none;
            padding: 0;
        }

        #indicator-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
        }

        .remove-button {
            background-color: #ff4d4d;
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }

        .remove-button:hover {
            background-color: #ff1a1a;
        }
    </style>
</head>
<body>
    <div id="indicator-management-panel">
        <h3>Added Indicators</h3>
        <ul id="indicator-list">
            <!-- Dynamically populated list -->
        </ul>
    </div>

    <script>
        // Listen for updates to the indicator registry
        window.addEventListener('message', function(event) {
            if (event.data.type === 'indicatorRegistryUpdate') {
                renderIndicatorList(event.data.indicators);
            }
        }, false);

        function renderIndicatorList(indicators) {
            const indicatorList = document.getElementById('indicator-list');
            indicatorList.innerHTML = ''; // Clear existing list

            for (const [id, metadata] of Object.entries(indicators)) {
                const listItem = document.createElement('li');
                listItem.textContent = metadata.name.join(', ');

                const removeButton = document.createElement('button');
                removeButton.textContent = 'Remove';
                removeButton.className = 'remove-button';
                removeButton.onclick = () => removeIndicator(id);

                listItem.appendChild(removeButton);
                indicatorList.appendChild(listItem);
            }
        }

        function removeIndicator(indicatorId) {
            // Send remove_indicator message to the main iframe
            window.parent.postMessage({
                type: 'remove_indicator_request',
                indicator_id: indicatorId
            }, '*'); // Replace '*' with specific origin if needed
        }

        // Initial load: Request the current indicator registry
        window.parent.postMessage({
            type: 'getIndicatorRegistry'
        }, '*'); // Replace '*' with specific origin if needed
    </script>
</body>
</html>
